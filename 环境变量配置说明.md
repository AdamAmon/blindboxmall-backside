# 环境变量配置说明

## 生产环境配置

### 1. 基本配置
```bash
# 应用配置
NODE_ENV=production
PORT=7001
APP_KEYS=your-production-app-keys-change-this

# JWT配置
JWT_SECRET=your-production-jwt-secret-change-this

# 前端地址
FRONTEND_URL=http://192.168.184.1:5173
```

### 2. 支付宝生产环境配置
```bash
# 支付宝生产环境配置
ALIPAY_APP_ID=your-production-app-id
ALIPAY_PRIVATE_KEY=-----BEGIN RSA PRIVATE KEY-----\n你的私钥内容\n-----END RSA PRIVATE KEY-----
ALIPAY_PUBLIC_KEY=-----BEGIN PUBLIC KEY-----\n支付宝公钥内容\n-----END PUBLIC KEY-----
ALIPAY_GATEWAY=https://openapi.alipay.com/gateway.do
ALIPAY_NOTIFY_URL=http://192.168.184.1:7001/api/pay/notify
```

### 3. 支付宝沙盒环境配置（开发测试用）
```bash
# 支付宝沙盒环境配置
ALIPAY_APP_ID=9021000149679684
ALIPAY_GATEWAY=https://openapi-sandbox.dl.alipaydev.com/gateway.do
ALIPAY_NOTIFY_URL=http://192.168.184.1:7001/api/pay/notify
ALIPAY_MOCK_RESPONSE=true
```

## 开发环境配置

### 1. 基本配置
```bash
NODE_ENV=development
PORT=7001
JWT_SECRET=dev-secret-key
FRONTEND_URL=http://localhost:5173
```

### 2. 支付宝沙盒配置
```bash
ALIPAY_APP_ID=9021000149679684
ALIPAY_GATEWAY=https://openapi-sandbox.dl.alipaydev.com/gateway.do
ALIPAY_NOTIFY_URL=http://localhost:7001/api/pay/notify
ALIPAY_MOCK_RESPONSE=true
```

## 密钥文件配置

### 1. 文件方式（推荐）
将支付宝密钥文件放在项目根目录：
- `private_key.pem` - 应用私钥
- `public_key.pem` - 支付宝公钥

### 2. 环境变量方式
如果不想使用文件，可以直接在环境变量中设置密钥内容：
```bash
ALIPAY_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----\n你的私钥内容\n-----END RSA PRIVATE KEY-----"
ALIPAY_PUBLIC_KEY="-----BEGIN PUBLIC KEY-----\n支付宝公钥内容\n-----END PUBLIC KEY-----"
```

## 启动命令

### 开发环境
```bash
npm run dev
```

### 生产环境
```bash
NODE_ENV=production npm start
```

### 使用环境变量文件
创建 `.env` 文件（注意：不要提交到版本控制）：
```bash
# .env 文件示例
NODE_ENV=production
ALIPAY_APP_ID=your-app-id
ALIPAY_PRIVATE_KEY=your-private-key
ALIPAY_PUBLIC_KEY=your-public-key
```

## 前端环境配置

### 1. 开发环境
前端会自动检测当前URL并选择合适的API地址：
- 本地开发：`http://localhost:7001`
- 生产环境：`http://192.168.184.1:7001`

### 2. 环境变量文件（可选）
可以在前端项目根目录创建 `.env` 文件：
```bash
# 开发环境
VITE_API_BASE_URL=http://localhost:7001

# 生产环境
# VITE_API_BASE_URL=http://192.168.184.1:7001
```

## 注意事项

1. **安全性**：生产环境的密钥和敏感信息不要提交到版本控制系统
2. **回调地址**：支付宝回调地址必须是公网可访问的，本地开发需要使用内网穿透工具
3. **跨域配置**：确保前端地址在跨域白名单中
4. **端口配置**：确保防火墙允许相应端口的访问
5. **前端配置**：前端会自动根据当前URL判断环境，无需手动配置 